ConsoleHISL3 Nháº­p chung danh má»¥i  Loáº¡i CDHA Loáº¡i XN Loáº¡i PTTT|ConsoleHISL3 Nháº­p chung danh má»¥i  Loáº¡i CDHA Loáº¡i XN Loáº¡i PTTT|ConsoleHISL3 Nháº­p chung danh má»¥i  Loáº¡i CDHA Loáº¡i XN Loáº¡i PTTT|(async () => {
  const loaiXNList = [
    { loai: 'Huyáº¿t há»c', mota: '1' },
    { loai: 'HÃ³a sinh', mota: '2' },
    { loai: 'NÆ°á»›c tiá»ƒu', mota: '3' },
    { loai: 'Vi sinh', mota: '4' },
    { loai: 'Loáº¡i khÃ¡c', mota: '5' }
  ];

  const loaiCDHAList = [
    { loai: 'SiÃªu Ã¢m', mota: 'SA' },
    { loai: 'X Quang', mota: 'XQ' },
    { loai: 'Äiá»‡n tim', mota: 'DT' },
    { loai: 'Ná»™i soi', mota: 'NS' },
    { loai: 'ThÄƒm dÃ² chá»©c nÄƒng', mota: 'TDCN' }
  ];
  
  const loaiPTTTlist = [
    { maloai: 'E', tenLoai: 'KhÃ¡m bá»‡nh', uuTien: '1' },
   { maloai: 'PT', tenLoai: 'Pháº«u thuáº­t', uuTien: '2' },
   { maloai: 'TT', tenLoai: 'Thá»§ thuáº­t', uuTien: '3' },
   ]; 

  const importBtn = document.createElement('button');
  importBtn.textContent = 'ðŸ“¥ Import Dá»¯ Liá»‡u';
  importBtn.style = `
    position: fixed;
    top: 10px;
    left: 10px;
    z-index: 9999;
    padding: 10px 15px;
    background: #e53935;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
  `;
  document.body.appendChild(importBtn);

  importBtn.onclick = async () => {
    // Kiá»ƒm tra vÃ  nháº­p dá»¯ liá»‡u cho div_loaixetnghiem
    const divLoaiXetNghiem = document.getElementById("div_loaixetnghiem");
    if (divLoaiXetNghiem) {
      for (let i = 0; i < loaiXNList.length; i++) {
        const { loai, mota } = loaiXNList[i];

        document.getElementById("loaixetnghiem").value = loai;
        document.getElementById("motaloaixn").value = mota;
        document.getElementById("themmoi").click();

        await new Promise(resolve => setTimeout(resolve, 1000));

        const popupBtn = document.getElementById("popup_ok");
        if (popupBtn) popupBtn.click();

        await new Promise(resolve => setTimeout(resolve, 1000));
      }
    }

    // Kiá»ƒm tra vÃ  nháº­p dá»¯ liá»‡u cho div_loaicdha
    const divLoaiCDHA = document.getElementById("div_loaicdha");
    if (divLoaiCDHA) {
      for (let i = 0; i < loaiCDHAList.length; i++) {
        const { loai, mota } = loaiCDHAList[i];

        document.getElementById("loaixetnghiem").value = loai;
        document.getElementById("motaloaixn").value = mota;
        document.getElementById("themmoi").click();

        await new Promise(resolve => setTimeout(resolve, 1000));

        const popupBtn = document.getElementById("popup_ok");
        if (popupBtn) popupBtn.click();

        await new Promise(resolve => setTimeout(resolve, 1000));
      }
    }
	
	// Kiá»ƒm tra vÃ  nháº­p dá»¯ liá»‡u cho div_loaidichvu
    const div_loaiDichvu = document.getElementById("div_loaidichvu");
    if (div_loaiDichvu) {
      for (let i = 0; i < loaiPTTTlist.length; i++) {
        const { maloai, tenLoai, uuTien } = loaiPTTTlist[i];

        document.getElementById("maloaixetnghiem").value = maloai;
        document.getElementById("tenloaixn").value = tenLoai;
		document.getElementById("uutien").value = uuTien;
		
        document.getElementById("themmoi").click();

        await new Promise(resolve => setTimeout(resolve, 1000));

        const popupBtn = document.getElementById("popup_ok");
        if (popupBtn) popupBtn.click();

        await new Promise(resolve => setTimeout(resolve, 1000));
      }
    }

    alert('âœ… ÄÃ£ import vÃ  xÃ¡c nháº­n xong táº¥t cáº£!');
  };
})();

SQL táº¡o DM BV BTL|VÃ o tool Excel to SQL --> Nháº­p DM cá»§a BV --> cháº¡y code|VÃ o tool Excel to SQL --> Nháº­p DM cá»§a BV --> cháº¡y code|select
  bang1.MA_THUOC,
  bang1.TEN_THUOC,
  bang1.HAM_LUONG,
  bang1.MA_DUONG_DUNG,
  bang1.SO_DANG_KY,
  bang1.TT_THAU,
  bang2.TT_THAU
from
  bang1
  JOIN bang2 ON bang1.MA_THUOC = bang2.MA_THUOC
  and bang1.TEN_THUOC = bang2.TEN_THUOC
  and bang1.HAM_LUONG = bang2.HAM_LUONG
  and bang1.MA_DUONG_DUNG = bang2.MA_DUONG_DUNG
  and bang1.SO_DANG_KY = bang2.SO_DANG_KY
  and bang1.TT_THAU <> bang2.TT_THAU;

  
  
select
  bang1.MA_THUOC,
  bang1.TEN_THUOC,
  bang1.HAM_LUONG,
  bang1.MA_DUONG_DUNG,
  bang1.SO_DANG_KY,
  bang1.TT_THAU
from
  bang1
where
  bang1.TEN_THUOC = 'Colistin';
  
  
  
SELECT
  bang2.MA_THUOC,
  bang2.TEN_THUOC,
  bang2.HAM_LUONG,
  bang2.MA_DUONG_DUNG,
  bang2.SO_DANG_KY,
  bang2.TT_THAU,
  bang1.TT_THAU as [ TT_THAU Báº£ng 1 ]
FROM
  bang2
  JOIN bang1 ON bang1.MA_THUOC = bang2.MA_THUOC
  AND bang1.TEN_THUOC = bang2.TEN_THUOC
  AND bang1.HAM_LUONG = bang2.HAM_LUONG
  AND bang1.MA_DUONG_DUNG = bang2.MA_DUONG_DUNG
  AND bang1.SO_DANG_KY = bang2.SO_DANG_KY
  where bang1.TT_THAU <> bang2.TT_THAU;
  
 SELECT
  bang2.HO_TEN,
  bang2.MA_BHXH,
  bang2.MA_KHOA
FROM
  bang2
LEFT JOIN
  bang1 ON bang2.HO_TEN = bang1.HO_TEN 
        AND bang2.MA_BHXH = bang1.MA_BHXH
WHERE
  bang1.HO_TEN IS NULL;
  
 
SELECT
  bang2.HO_TEN,
  bang2.MA_BHXH,
  bang2.MA_KHOA
FROM
  bang2
WHERE
  NOT EXISTS (
    SELECT 1
    FROM bang1
    WHERE bang2.HO_TEN = bang1.HO_TEN
      AND bang2.MA_BHXH = bang1.MA_BHXH
  );


SELECT
  bang2.HO_TEN,
  bang2.MA_BHXH,
  bang2.MA_KHOA
FROM
  bang2
JOIN
  bang1 ON bang2.HO_TEN = bang1.HO_TEN 
WHERE
  bang2.MA_BHXH <> bang1.MA_BHXH;
  




#### Táº¡o DM Thuá»‘c tá»« DM BV BTL
SELECT 
    bang1.MANHOM AS MA_NHOM, 
    bang1.MALOAI AS MA_LOAI,
	bang1.TENNHOM AS TEN_NHOM_KHONG_DUNG,
    bang1.MAHC5084 AS MA_HOAT_CHAT, 
    bang1.TENHC HOAT_CHAT, 
    '' AS STT,
    '' AS MA_ACT, 
    bang1.MAHC5084 AS MA_BYT,
    bang1.SODK AS SO_DANG_KY,
    bang1.MA AS MA_THUOC,
    bang1.TEN AS TEN_THUOC,
    bang1.HAMLUONG AS HAM_LUONG, 
    bang1.DANG AS DON_VI_TINH, 
    bang1.DONVI AS DONG_GOI, 
    bang1.DUONGDUNG2182 AS MA_DUONG_DUNG, 
    bang1.DUONGDUNG AS DUONG_DUNG, 
    bang1.HAMLUONG AS LIEU_LUONG, 
    bang1.TENHANG AS HANG_SX, 
    bang1.TENNUOC AS NUOC_SX, 
    bang1.TENNX AS NHA_CUNG_CAP, 
    bang1.LOAITHAU AS MA_NHOM_THAU, 
    '' AS GOI_THAU, 
    '' AS SO_GOI_THAU, 
    '' AS DANGBAOCHE, 
    '' AS TYLEHUHAO, 
    bang1.TTTHAU AS QUYET_DINH, 
    '' AS CONG_BO, 
    '' AS STT_THAU, 
    bang1.TENBD AS TEN_GIAM_DINH_BH, 
    bang1.BHYT AS BHYT_CHI_TRA, 
    bang1.DONGIA AS GIA_BHYT_QUYET_TOAN, 
    bang1.DONGIA AS GIA_THAU, 
    bang1.DONGIA AS GIA_BAN, 
    bang1.MA AS MA_THUOC_BV, 
    bang1.DONGIA AS GIA_BHYT, 
    bang1.DONGIA AS GIA_DICH_VU, 
	'' AS NGUONCT, 
    '' AS THUOCPHONGXA, 
    '' AS DUOCPHEPKELE, 
    '' AS VITHUOCYHCT, 
    '' AS KETRUNGHOATCHAT, 
    bang1.TENIN AS THUOCTANDUOC, 
    '' AS CHEPHAMYHCT, 
    '' AS THUOCKHANGSINH, 
    '' AS KHONGTINHXNT, 
    '' AS DANHSTTDUNGTHUOC, 
    '' AS THUOCNHIEUHOATCHAT, 
    '' AS THUOCKEDON, 
    '' AS TIENCHATGNHT, 
    '' AS QLTHEOTUIMAU, 
    '' AS DUOCDUYETLE, 
    '' AS THUOCDIEUTRILAO, 
    '' AS THUOCCORTICOID, 
    '' AS SOGIAYPHEP, 
    '' AS NHOM_BHXH, 
    bang1.TTTHAU AS THAUGHEP, 
    '' AS MA_PP_CHEBIEN, 
    '' AS MAHIEUSP
FROM 
    bang1
JOIN 
    bang2 ON bang1.MA = bang2.MA;
	
######## Táº¡o DVKT tá»« DM BV Báº¯c ThÄƒng Long
SELECT 
    bang1.MA AS MA_DICH_VU,
    bang1.TEN AS TEN_DICH_VU,
    bang1.TEN_LOAI AS MA_NHOM,
    bang1.NHOMBHXH AS NHOM_BHXH_KHONG_DUNG,
    bang1.TEN_NHOM AS NHOM_BHYT,
    bang1.MA5084 AS MA_BHYT,
    bang1.DVT AS DON_VI_TINH,
    bang1.GIA_BH AS GIA_BHYT,
    bang1.GIA_TH AS GIA_VIEN_PHI,
    bang1.GIA_DV AS GIA_YEU_CAU,
    bang1.GIA_NN AS GIA_NUOC_NGOAI,
    bang1.QUYETDINH AS QUYET_DINH,
    '20241115' AS NGAY_CONG_BO,
    '' AS STT_MAU_21,  
    bang1.MA5084 AS MA_BYT_MAU_21,
    bang1.MATT37 AS MA_TT_37,
    bang1.MATT43 AS MA_TT_4350,
    bang1.TEN43 AS TEN_BAO_HIEM,
    '' AS LOAI_PTTT,
    '' AS MA_CHUYEN_KHOA,
    bang1.TEN43 AS TEN_BH_MOI
FROM bang1;
